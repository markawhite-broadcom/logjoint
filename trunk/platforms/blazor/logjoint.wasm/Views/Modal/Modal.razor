@namespace  LogJoint.Wasm.UI

@if (Visible)
{
    <div class="modal" @onmousedown="HandleClickOutside" @onkeydown="HandleKeyDown">
        <div class="contents @Class" @onmousedown:stopPropagation>
            @ChildContent
        </div>
    </div>
}

@code {
    [Parameter]
    public RenderFragment ChildContent { get; set; }

    [Parameter]
    public bool Visible { get; set; } = false;

    [Parameter]
    public string Class { get; set; } = "";

    [Parameter]
    public Action ClickOutside { get; set; }

    [Parameter]
    public Action OnCancel { get; set; }

    async void HandleClickOutside()
    {
        await Task.Yield();
        ClickOutside?.Invoke();
    }

    async void HandleKeyDown(KeyboardEventArgs eventArgs)
    {
        if (eventArgs.Key == "Escape")
        {
            await Task.Yield();
            OnCancel?.Invoke();
        }
    }
}
